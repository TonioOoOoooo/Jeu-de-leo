<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="screen-orientation" content="landscape">
    <title>L'Aventure de LÃ©o - Version 2.0</title>
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="L'Aventure de LÃ©o">
    <meta property="og:title" content="L'Aventure de LÃ©o - Version 2.0">
    <meta property="og:description" content="Un jeu de plateforme Ã©pique en 10 niveaux !">
    <meta property="og:url" content="https://jeu-de-leo.netlify.app/">
    <meta property="og:image" content="https://jeu-de-leo.netlify.app/assets/leo-heroes.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="L'Aventure de LÃ©o - Version 2.0">
    <meta name="twitter:description" content="Un jeu de plateforme Ã©pique en 10 niveaux !">
    <meta name="twitter:image" content="https://jeu-de-leo.netlify.app/assets/leo-heroes.jpg">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <link rel="icon" href="assets/favicon.ico">
    <link rel="manifest" href="assets/site.webmanifest">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <!-- SETTINGS OVERLAY -->
    <div class="settings-overlay" id="settings-overlay" onclick="closeSettings()"></div>

    <!-- SETTINGS PANEL -->
    <div class="settings-panel" id="settings-panel">
        <div class="settings-header">
            <h3 class="settings-title">âš™ï¸ ParamÃ¨tres</h3>
            <button class="settings-close" onclick="closeSettings()">âœ•</button>
        </div>

        <div class="settings-group">
            <div class="settings-group-title">Audio & Affichage</div>
            <div class="settings-item">
                <span class="settings-label"><span class="settings-label-icon">ğŸ”Š</span> Sons</span>
                <div class="toggle-switch active" id="sound-toggle" onclick="toggleSound()"></div>
            </div>
            <div class="settings-item">
                <span class="settings-label"><span class="settings-label-icon">â±ï¸</span> Timer</span>
                <div class="toggle-switch" id="timer-toggle" onclick="toggleTimer()"></div>
            </div>
            <div class="settings-item" id="fullscreen-option">
                <span class="settings-label"><span class="settings-label-icon">ğŸ“º</span> Plein Ã©cran</span>
                <div class="toggle-switch" id="fullscreen-toggle" onclick="toggleFullscreen()"></div>
            </div>
        </div>

        <div class="settings-group">
            <div class="settings-group-title">ContrÃ´les</div>
            <p style="color: rgba(255,255,255,0.7); font-size: 14px; line-height: 1.6;">
                <strong>A / Z</strong> â€” Se dÃ©placer<br>
                <strong>ESPACE / â†‘</strong> â€” Sauter<br>
                <strong>â†‘ / â†“</strong> â€” Ã‰chelles<br>
                <strong>Ã‰CHAP</strong> â€” Pause
            </p>
        </div>

        <div class="settings-group">
            <div class="settings-group-title">Cheats ğŸ®</div>
            <p style="color: rgba(255,255,255,0.5); font-size: 12px; line-height: 1.6;">
                1-9 = niveau â€¢ + / - = niveau suivant/prÃ©cÃ©dent<br>
                = ou ENTRÃ‰E (pavÃ© num.) = vie supplÃ©mentaire
            </p>
        </div>
    </div>

    <!-- START SCREEN -->
    <div id="start-screen" class="screen">
        <!-- Settings FAB -->
        <button class="settings-fab" onclick="openSettings()" title="ParamÃ¨tres">âš™ï¸</button>

        <video id="start-bg-video" class="start-bg-video" muted playsinline preload="auto" poster="assets/leo-heroes.jpg">
            <source src="assets/leo-heroes.mp4" type="video/mp4">
        </video>

        <div class="start-header">
            <h1 class="game-title">L'Aventure de LÃ©o</h1>
            <p class="subtitle">Un jeu de plateforme Ã©pique en 10 niveaux !</p>
        </div>

        <div class="start-footer">
            <div id="saved-game" style="display: none;">
                <p>ğŸ“ Partie sauvegardÃ©e trouvÃ©e !</p>
                <p id="saved-info"></p>
                <button class="big-btn btn-continue" onclick="continueSavedGame()">â–¶ï¸ CONTINUER</button>
            </div>

            <p class="subtitle" style="margin-top: 10px;">Choisis ta difficultÃ© :</p>

            <!-- Difficulty Cards -->
            <div class="difficulty-container">
            <div class="difficulty-card very-easy" data-start="very_easy">
                <span class="difficulty-icon">ğŸŒˆ</span>
                <div class="difficulty-label">TRÃˆS FACILE</div>
                <div class="difficulty-desc">10 vies â€¢ Ennemis lents â€¢ Aide du compagnon</div>
            </div>
            <div class="difficulty-card easy" data-start="easy">
                <span class="difficulty-icon">ğŸ˜Š</span>
                <div class="difficulty-label">FACILE</div>
                <div class="difficulty-desc">7 vies â€¢ Ennemis lents â€¢ Hitbox tolÃ©rante</div>
            </div>
            <div class="difficulty-card medium" data-start="medium">
                <span class="difficulty-icon">ğŸ’ª</span>
                <div class="difficulty-label">MOYEN</div>
                <div class="difficulty-desc">4 vies â€¢ DifficultÃ© standard</div>
            </div>
            <div class="difficulty-card hard" data-start="hard">
                <span class="difficulty-icon">ğŸ˜ˆ</span>
                <div class="difficulty-label">DUR</div>
                <div class="difficulty-desc">2 vies â€¢ Ennemis rapides â€¢ Sans pitiÃ© !</div>
            </div>
            </div>

            <!-- Menu Bar -->
            <div class="menu-bar">
                <button class="menu-btn" onclick="showCustomization()">
                    <span class="menu-btn-icon">ğŸ¨</span> Personnaliser
                </button>
                <button class="menu-btn" onclick="showStats()">
                    <span class="menu-btn-icon">ğŸ“Š</span> Stats
                </button>
                <button class="menu-btn" onclick="showBadges()">
                    <span class="menu-btn-icon">ğŸ†</span> Badges
                </button>
            </div>
        </div>
    </div>

    <!-- CUSTOMIZATION SCREEN -->
    <div id="customization-screen" class="screen" style="display: none;">
        <h2>ğŸ¨ Personnalisation</h2>
        <p class="subtitle">Choisis ton style !</p>

        <p class="subtitle" style="margin-top: 15px;">Ta couleur prÃ©fÃ©rÃ©e :</p>
        <div class="color-grid">
            <button class="color-btn" data-color="#3498db" style="background: #3498db;">ğŸ’™</button>
            <button class="color-btn" data-color="#e74c3c" style="background: #e74c3c;">â¤ï¸</button>
            <button class="color-btn" data-color="#2ecc71" style="background: #2ecc71;">ğŸ’š</button>
            <button class="color-btn" data-color="#9b59b6" style="background: #9b59b6;">ğŸ’œ</button>
            <button class="color-btn" data-color="#f39c12" style="background: #f39c12;">ğŸ§¡</button>
            <button class="color-btn" data-color="#1abc9c" style="background: #1abc9c;">ğŸ’</button>
            <button class="color-btn" data-color="#e91e63" style="background: #e91e63;">ğŸ’—</button>
            <button class="color-btn" data-color="#00bcd4" style="background: #00bcd4;">ğŸ©µ</button>
        </div>

        <p class="subtitle" style="margin-top: 20px;">Ton compagnon :</p>
        <div class="companion-grid">
            <button class="companion-btn" data-companion="cat" data-name="Minou">ğŸ± Chat</button>
            <button class="companion-btn" data-companion="dog" data-name="Toutou">ğŸ¶ Chien</button>
            <button class="companion-btn" data-companion="bird" data-name="Piou">ğŸ¦ Oiseau</button>
            <button class="companion-btn" data-companion="rabbit" data-name="Lapinou">ğŸ° Lapin</button>
            <button class="companion-btn" data-companion="dragon" data-name="Flammy">ğŸ‰ Dragon</button>
            <button class="companion-btn" data-companion="unicorn" data-name="Licornou">ğŸ¦„ Licorne</button>
            <button class="companion-btn" data-companion="bear" data-name="Nounours">ğŸ» Ours</button>
            <button class="companion-btn" data-companion="fox" data-name="RusÃ©">ğŸ¦Š Renard</button>
            <button class="companion-btn" data-companion="panda" data-name="Bambou">ğŸ¼ Panda</button>
            <button class="companion-btn" data-companion="lion" data-name="Roi">ğŸ¦ Lion</button>
        </div>

        <div id="customization-preview">
            <p>AperÃ§u : <span id="preview-color">Bleu</span> avec <span id="preview-companion">ğŸ± Minou</span></p>
        </div>

        <button class="big-btn btn-continue" style="margin-top: 20px;" onclick="closeCustomization()">âœ… C'est bon !</button>
    </div>

    <!-- BADGES SCREEN -->
    <div id="badges-screen" class="screen" style="display: none;">
        <h2>ğŸ† Mes Badges</h2>
        <p class="subtitle">Collectionne tous les badges !</p>

        <div id="badges-grid">
            <!-- Badges will be inserted here by JavaScript -->
        </div>

        <button class="big-btn btn-continue" style="margin-top: 30px;" onclick="closeBadges()">â¬…ï¸ Retour</button>
    </div>

    <!-- STATS SCREEN -->
    <div id="stats-screen" class="screen" style="display: none;">
        <h2>ğŸ“Š Statistiques</h2>
        <p class="subtitle">Tes exploits de champion !</p>

        <div id="stats-container">
            <!-- Stats will be inserted here by JavaScript -->
        </div>

        <button class="big-btn btn-continue" style="margin-top: 30px;" onclick="closeStats()">â¬…ï¸ Retour</button>
    </div>

    <!-- COMPANION DISPLAY (in-game) -->
    <div id="companion-bubble" style="display: none; position: fixed; bottom: 150px; left: 20px; background: white; padding: 15px 20px; border-radius: 20px; border: 3px solid #333; max-width: 280px; z-index: 999; font-size: 18px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); pointer-events: none;">
        <div id="companion-icon" style="font-size: 40px; margin-bottom: 8px;">ğŸ±</div>
        <div id="companion-text" style="color: #333; line-height: 1.4;">Salut LÃ©o ! Tu vas y arriver !</div>
    </div>

    <!-- MATH MINI-GAME (Bonus between levels) -->
    <div id="math-game" class="screen" style="display: none; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
        <h2 style="font-size: 42px; color: #333; margin: 0;">ğŸ§® Quiz Bonus !</h2>
        <p style="color: #555; font-size: 18px;">RÃ©ponds pour gagner des piÃ¨ces bonus !</p>

        <div style="background: white; padding: 30px 50px; border-radius: 20px; margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
            <p id="math-question" style="font-size: 48px; color: #333; margin: 0;">5 + 3 = ?</p>
        </div>

        <div id="math-answers" style="display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; justify-content: center;">
            <!-- RÃ©ponses gÃ©nÃ©rÃ©es par JavaScript -->
        </div>

        <div id="math-result" style="margin-top: 20px; font-size: 24px; color: #333; min-height: 40px;"></div>

        <button id="math-skip" class="big-btn btn-medium" style="margin-top: 20px;" onclick="skipMathGame()">Passer â­ï¸</button>
    </div>

    <!-- STREAK INDICATOR -->
    <div id="streak-indicator">ğŸ”¥ SÃ©rie : <span id="streak-count">0</span></div>

    <!-- PAUSE SCREEN -->
    <div id="pause-screen" class="screen">
        <h2 style="font-size: 50px; color: white; margin: 0;">â¸ï¸ PAUSE</h2>
        <p style="font-size: 24px; color: rgba(255,255,255,0.8);">Niveau <span id="pause-level">1</span></p>
        
        <div class="difficulty-container" style="margin-top: 30px;">
            <button class="big-btn btn-continue" onclick="resumeGame()">â–¶ï¸ REPRENDRE</button>
            <button class="big-btn btn-easy" onclick="restartLevel()">ğŸ”„ RECOMMENCER</button>
            <button class="big-btn btn-hard" onclick="quitToMenu()">ğŸ  MENU</button>
        </div>
        
        <p style="margin-top: 30px; color: rgba(255,255,255,0.5);">(Ã‰CHAP pour reprendre)</p>
    </div>

    <!-- TRANSITION SCREEN -->
    <div id="transition-screen" class="screen">
        <h2 id="transition-text" style="font-size: 50px; color: white;">NIVEAU 2</h2>
    </div>

    <!-- UI LAYER -->
    <div id="ui-layer">
        <div id="hud">
            <span id="level-display">NIVEAU 1</span>
            <span id="coins-display">ğŸª™ 0</span>
            <span id="stars-display">â­ 0</span>
            <span id="hearts">â¤ï¸â¤ï¸â¤ï¸</span>
            <span id="key-display">ğŸ—ï¸ CLÃ‰ !</span>
            <button id="menu-button" onclick="togglePause()" title="Menu (Ã‰chap)">â¸ï¸ MENU</button>
        </div>
        
        <div id="timer-display">â±ï¸ 00:00</div>
        
        <div id="progress-bar"></div>
        
        <div id="jump-indicator">
            <div class="jump-dot available" id="jump1"></div>
            <div class="jump-dot available" id="jump2"></div>
            <div class="jump-dot available" id="jump3" style="display: none;"></div>
        </div>
        
        <div id="tutorial">
            <h3>ğŸ® Comment jouer</h3>

            <!-- TUTORIEL DESKTOP -->
            <div class="tutorial-desktop">
                <div class="tutorial-step active" id="tutorial-step-1">
                    <p class="tutorial-arrow">ğŸ‘‰</p>
                    <p><strong>Appuie sur A</strong> pour aller Ã  gauche</p>
                    <p><strong>Appuie sur Z</strong> pour aller Ã  droite</p>
                    <button onclick="nextTutorialStep(2)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-step-2">
                    <p style="font-size: 40px;">ğŸ¦˜</p>
                    <p><strong>ESPACE</strong> = Sauter !</p>
                    <p>Tu peux sauter <strong>2 fois</strong> de suite !</p>
                    <button onclick="nextTutorialStep(3)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-step-3">
                    <p style="font-size: 40px;">ğŸªœ</p>
                    <p>Utilise <strong>â†‘ â†“</strong> pour les Ã©chelles</p>
                    <button onclick="nextTutorialStep(4)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-step-4">
                    <p style="font-size: 40px;">ğŸ—ï¸ â¡ï¸ ğŸšª</p>
                    <p>Trouve la <strong>clÃ©</strong> pour ouvrir la porte !</p>
                    <p>Collecte les <strong>piÃ¨ces ğŸª™</strong> pour des points !</p>
                    <button onclick="closeTutorial()">C'est parti ! ğŸš€</button>
                </div>
            </div>

            <!-- TUTORIEL MOBILE (simplifiÃ©) -->
            <div class="tutorial-mobile">
                <div class="tutorial-step active" id="tutorial-mobile-step-1">
                    <p style="font-size: 50px;">ğŸ•¹ï¸</p>
                    <p><strong>Glisse ton pouce</strong> sur le joystick<br>pour te dÃ©placer !</p>
                    <button onclick="nextMobileTutorialStep(2)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-mobile-step-2">
                    <p style="font-size: 50px;">ğŸ¦˜</p>
                    <p>Appuie sur le <strong>bouton vert</strong><br>pour sauter !</p>
                    <p style="font-size: 14px; opacity: 0.8;">Tu peux sauter 2 fois de suite !</p>
                    <button onclick="nextMobileTutorialStep(3)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-mobile-step-3">
                    <p style="font-size: 50px;">ğŸªœ</p>
                    <p>Pour grimper aux Ã©chelles,<br><strong>pousse le joystick vers le haut !</strong></p>
                    <button onclick="nextMobileTutorialStep(4)">Suivant â¡ï¸</button>
                </div>

                <div class="tutorial-step" id="tutorial-mobile-step-4">
                    <p style="font-size: 40px;">ğŸ—ï¸ â¡ï¸ ğŸšª</p>
                    <p>Trouve la <strong>clÃ©</strong> pour ouvrir la porte !</p>
                    <p>Collecte les <strong>piÃ¨ces ğŸª™</strong> !</p>
                    <button onclick="closeTutorial()">C'est parti ! ğŸš€</button>
                </div>
            </div>
        </div>

        <div id="message-box">
            <h2 id="msg-title" style="font-size: 50px; margin: 0;">Bravo !</h2>
            <p id="msg-text" style="font-size: 28px;">...</p>
            <p id="msg-coins" style="font-size: 20px; color: gold;"></p>
            <button class="big-btn btn-easy" id="msg-btn" onclick="nextLevelAction()">Continuer</button>
            <p class="space-hint" id="msg-hint">(ESPACE pour continuer)</p>
        </div>

        <div id="hall-of-fame" class="screen" style="display: none;">
            <h2 style="font-size: 48px; color: gold; margin: 0;">ğŸ† Hall of Fame</h2>
            <p id="hall-score" style="font-size: 26px; color: white; margin: 10px 0 20px;"></p>
            <ol id="hall-list" style="list-style: decimal; padding-left: 24px; text-align: left; color: white; font-size: 22px; max-width: 420px;"></ol>
            <div id="hall-form" style="margin-top: 20px;">
                <p style="font-size: 20px; color: rgba(255,255,255,0.9); margin-bottom: 10px;">Entre ton nom :</p>
                <input id="hall-name" type="text" maxlength="12" placeholder="LEO" style="padding: 8px 12px; font-size: 20px; border-radius: 10px; border: none; text-align: center;">
                <div style="margin-top: 15px;">
                    <button class="big-btn btn-easy" onclick="submitHallOfFame()">Enregistrer</button>
                </div>
            </div>
            <p id="hall-message" style="font-size: 18px; color: rgba(255,255,255,0.8); margin-top: 12px;"></p>
            <button class="big-btn btn-hard" style="margin-top: 20px;" onclick="returnToMenu()">ğŸ  Menu</button>
        </div>

        <div class="btn" id="btn-pause-mobile" onclick="togglePause()">â¸ï¸</div>

        <div id="controls">
            <!-- Joystick virtuel (gauche) -->
            <div id="joystick-zone">
                <div id="joystick-base">
                    <div id="joystick-thumb"></div>
                </div>
            </div>
            <!-- Bouton SAUT gÃ©ant (droite) -->
            <div id="jump-zone">
                <div class="btn" id="btn-jump">ğŸ¦˜</div>
            </div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <!-- Scripts dans l'ordre de dÃ©pendance -->
    <script src="js/config.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/particles.js"></script>
    <script src="js/player.js"></script>
    <script src="js/fruity-frank.js"></script>
    <script src="js/levels.js"></script>
    <script src="js/visual-enhancements.js"></script>
    <script src="js/game.js"></script>
    <script src="js/draw.js"></script>
    <script src="js/ui.js"></script>
    
    <!-- Initialisation -->
    <script>
        // DÃ©marrer le jeu quand tout est chargÃ©
        window.addEventListener('load', init);
    </script>
</body>
</html>
